<!DOCTYPE html>
<html lang="en">
<head>
    <!--This file, magapp.js and style.css are staying in /home/web which is link to other folder. original services.html needs to be renamed"-->
    <meta charset="UTF-8">
    <title>MAG Portal</title>

    <link rel="stylesheet" type="text/css" href="style.css">

    <script type="text/javascript" src="magapp.js"></script>

    <script>

        const doVisualLog=false;
        function LogMessageInt(message) {
            var now = new Date().toUTCString();

            var logM = now + "  ::  " + message;
            console.log(logM);

            var myLog = gSTB.LoadUserData("mylog.log");
            myLog += logM+"\n";
            gSTB.SaveUserData("mylog.log", myLog);          

            if (doVisualLog)
            {
                var logging = document.getElementById("logging");
                if ((typeof logging === 'undefined') || logging === null) {
                    //document.body.innerHTML += now + "\t" + message + "\n";
                    return;
                }

                var allText = logging.innerHTML + logM + "<br>";

                var splited = allText.split("<br>");

                while (splited.length > 26) {
                    splited.shift();
                }
                allText = "";
                splited.forEach(
                    function (elm) {
                        if (elm !== "") {
                            allText += elm + "<br>";
                        }
                    }
                );

                logging.innerHTML = allText;
            }
        }


        window.onerror = function (msg, url, line, col, error) {
            var extra = !col ? '' : '\ncolumn: ' + col;
            extra += !error ? '' : '\nerror: ' + error +"  ";

            // if (error.stack)
            // {
            //     LogMessageInt("Stack is "+error.stack);
            // }


            LogMessageInt("Error: " + msg + "\nurl: " + url + "\nline: " + line + extra+"\n");

            // If you return true, then error alerts (like in older versions of
            // Internet Explorer) will be suppressed.
            return true;
        };

        document.addEventListener("DOMContentLoaded", function() {
            LogMessageInt("Load Done");

            magBootUp();
        });

    </script>




</head>
<body>
<div id="time" class="time">Hello</div>
<div id="LAN" class="LAN">Hello</div>
<div id="Notification" class="Notification"></div>


<div id="serveripform" class="serveripform">
    <h2 class="textup">API Backend configuration</h2>
<label for="SERVERIP">API Server host</label><input type="text" id="SERVERIP" name="ServerIP" class="IPEDIT"/><span id="ipval"></span>
    <p style="text-align: center">OK to save, ESC to cancel</p>
</div>



<div id="logging" class="logging"></div>

</body>
<!--<script src="http://10.10.10.198:8080/target/target-script-min.js#anonymous"></script>-->
</html>

